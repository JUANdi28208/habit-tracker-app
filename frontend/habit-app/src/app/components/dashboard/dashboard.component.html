<div class="min-vh-100" style="background: #f8f9fa">
  <!-- Navbar -->
  <app-navbar></app-navbar>

  <div class="container-fluid px-4 py-4">
    <!-- Tarjeta de Gamificaci√≥n -->
    <div class="row g-4 mb-4" *ngIf="userStats">
      <div class="col-12">
        <div class="gamification-card">
          <div class="row align-items-center">
            <div class="col-md-3 text-center">
              <div class="level-badge">
                <div class="level-number">{{ userStats.level }}</div>
                <div class="level-label">Nivel</div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-2">
                <div class="d-flex justify-content-between mb-1">
                  <span class="fw-semibold">Progreso al siguiente nivel</span>
                  <span class="text-muted"
                    >{{ userStats.points }} /
                    {{ userStats.points_to_next_level }} pts</span
                  >
                </div>
                <div class="progress" style="height: 20px">
                  <div
                    class="progress-bar bg-success"
                    [style.width.%]="
                      (userStats.points / userStats.points_to_next_level) * 100
                    "
                  ></div>
                </div>
              </div>
              <div
                class="motivational-phrase text-center fst-italic text-muted mt-3"
              >
                "{{ userStats.motivational_phrase }}"
              </div>
            </div>
            <div class="col-md-3 text-center">
              <button
                class="btn btn-success btn-lg w-100"
                (click)="goToAchievements()"
              >
                Ver Todos los Logros
              </button>

              <div class="mt-2 text-muted">
                {{ userStats.unlocked_achievements }} logros desbloqueados
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="row g-4 mb-4" *ngIf="stats">
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number text-success">{{ stats.total_habits }}</div>
          <div class="stat-label">Total H√°bitos</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number text-primary">{{ stats.active_habits }}</div>
          <div class="stat-label">H√°bitos Activos</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number text-warning">{{ stats.best_streak }} üî•</div>
          <div class="stat-label">Mejor Racha</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-card">
          <div class="stat-number text-info">{{ stats.total_completions }}</div>
          <div class="stat-label">Total Completados</div>
        </div>
      </div>
    </div>

    <!-- Bot√≥n Nuevo H√°bito -->
    <div class="row mb-4">
      <div class="col-12">
        <button
          class="btn btn-gradient btn-lg w-100 fw-semibold"
          (click)="toggleHabitForm()"
        >
          <span *ngIf="!showHabitForm">‚ûï Crear Nuevo H√°bito</span>
          <span *ngIf="showHabitForm">‚ùå Cancelar</span>
        </button>
      </div>
    </div>

    <!-- Formulario de H√°bito -->
    <app-habit-form *ngIf="showHabitForm" (habitCreated)="onHabitCreated()">
    </app-habit-form>

    <!-- Lista de H√°bitos -->
    <app-habit-list [habits]="habits" (habitsChanged)="loadData()">
    </app-habit-list>
  </div>
</div>
